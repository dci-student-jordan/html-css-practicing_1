<!DOCTYPE html>
<head>
  <link rel="stylesheet" href="../style.css">
</head>
<html>
<header>
  <h1>A heading here</h1>
</header>
<body>
  <h1>My first requested Data</h1>
<section class="content">
  <input id="fetchButton" type="button" value="Get data" onclick="getResponse();" />
  <p id="iss">Fetch some free data awailable with this button.</p>
</section>
<script>
  var fetching = false
  const fetchText = document.querySelector("#iss")
  async function getResponse() {
    fetching = true
    fetchText.textContent = "fetching data.."
    fetchingData()
    const host = 'api.open-notify.org';
      fetch(`http://${host}/astros.json`)
      .then(resp => resp.json())
      .then((data) => {
        var numText = document.createTextNode(`Currently  ${data.number} people are in space right now: `)
        fetchText.parentNode.appendChild(numText, fetchText)
        for (i=0; i<data.people.length; i++) {
          var guy = data.people[i]
          var guyText = document.createTextNode(guy.name+ " is on the "+guy.craft + ((i==(data.people.length-2)) ? " and " : (i==(data.people.length-1)) ? "." : ", "))
          fetchText.parentNode.appendChild(guyText, fetchText);
        }
      })
      fetch(`http://${host}/iss-now.json`)
      .then(resp => resp.json())
      .then((data) => {
        fetching = false
        fetchText.textContent = `the ISS is Located here :Latitude :${data.iss_position.latitude}; Longitude: ${data.iss_position.longitude}`;
      })
  }
  function fetchingData () {
    fetchText.textContent = fetchText.textContent + "."
    if (fetching) setTimeout(()=> {fetchingData()},500)
  }
</script>
</body>

</html>